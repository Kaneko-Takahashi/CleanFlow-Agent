# 画面設計書 - CleanFlow Agent

## 共通レイアウト

### 基本構造

- **ヘッダー**: 上部に固定
  - 左側: ロゴ「CleanFlow Agent」
  - 右側: 現在ログイン中のユーザーメールアドレス表示
- **サイドバー**: 左側に固定（ログイン後のみ表示）
  - データセット
  - 前処理プラン
  - ログアウト
- **メインコンテンツエリア**: 中央・右側の広い領域

### デザイン方針

- モダンでクリーンな UI
- レスポンシブデザイン（モバイル対応は将来拡張）
- カラースキーム: ライトテーマ（ダークテーマは将来拡張）

## 画面一覧

### 1. ログイン画面

#### URL

```
/login
```

#### 画面要素

- **タイトル**: 「CleanFlow Agent にログイン」
- **メールアドレス入力欄**
  - プレースホルダー: "user@example.com"
  - バリデーション: メール形式チェック
- **パスワード入力欄**
  - タイプ: password（入力時に非表示）
  - プレースホルダー: "パスワード"
- **ログインボタン**
  - プライマリカラー
  - クリック時にローディング表示
- **新規登録リンク**
  - 「アカウントをお持ちでない方はこちら」→ ユーザー登録画面へ
- **エラーメッセージ表示エリア**
  - 認証失敗時に赤色で表示

#### レイアウト

```
┌─────────────────────────────────┐
│      CleanFlow Agent            │
│                                 │
│   ┌───────────────────────┐   │
│   │  メールアドレス        │   │
│   │  [入力欄]              │   │
│   └───────────────────────┘   │
│                                 │
│   ┌───────────────────────┐   │
│   │  パスワード            │   │
│   │  [入力欄]              │   │
│   └───────────────────────┘   │
│                                 │
│   [ログイン]                    │
│                                 │
│   アカウントをお持ちでない方は  │
│   こちら                        │
└─────────────────────────────────┘
```

### 2. ユーザー登録画面

#### URL

```
/register
```

#### 画面要素

- **タイトル**: 「新規ユーザー登録」
- **メールアドレス入力欄**
  - プレースホルダー: "user@example.com"
  - バリデーション: メール形式チェック、重複チェック
- **パスワード入力欄**
  - タイプ: password
  - プレースホルダー: "パスワード（8 文字以上）"
  - バリデーション: 最低 8 文字
- **パスワード確認入力欄**
  - タイプ: password
  - プレースホルダー: "パスワード（確認）"
  - バリデーション: パスワードと一致チェック
- **登録ボタン**
  - プライマリカラー
  - クリック時にローディング表示
- **ログイン画面へのリンク**
  - 「既にアカウントをお持ちの方はこちら」→ ログイン画面へ
- **エラーメッセージ表示エリア**
  - バリデーションエラー時に赤色で表示

#### レイアウト

```
┌─────────────────────────────────┐
│      CleanFlow Agent            │
│                                 │
│   ┌───────────────────────┐   │
│   │  メールアドレス        │   │
│   │  [入力欄]              │   │
│   └───────────────────────┘   │
│                                 │
│   ┌───────────────────────┐   │
│   │  パスワード            │   │
│   │  [入力欄]              │   │
│   └───────────────────────┘   │
│                                 │
│   ┌───────────────────────┐   │
│   │  パスワード（確認）    │   │
│   │  [入力欄]              │   │
│   └───────────────────────┘   │
│                                 │
│   [登録]                        │
│                                 │
│   既にアカウントをお持ちの方は  │
│   こちら                        │
└─────────────────────────────────┘
```

### 3. データセット一覧画面

#### URL

```
/datasets
```

#### 画面要素

- **ページタイトル**: 「データセット一覧」
- **CSV アップロードボタン**
  - プライマリカラー
  - クリックでファイル選択ダイアログを開く
  - アップロード中はローディング表示
- **データセットテーブル**
  - カラム:
    - データセット名
    - 行数
    - 列数
    - 作成日時
    - 操作（詳細ボタン、削除ボタン）
  - ソート機能（作成日時で降順がデフォルト）
  - 空の場合は「データセットがありません」メッセージ表示

#### レイアウト

```
┌─────────────────────────────────────────────────────┐
│ CleanFlow Agent    [user@example.com]               │
├──────────┬──────────────────────────────────────────┤
│ データセット │  [CSVアップロード]                    │
│ 前処理プラン │                                       │
│ ログアウト  │  ┌─────────────────────────────────┐ │
│            │  │ データセット名 │ 行数 │ 列数 │ ... │ │
│            │  ├─────────────────────────────────┤ │
│            │  │ my_dataset    │ 1000 │ 10   │ ... │ │
│            │  │ [詳細] [削除]                   │ │
│            │  └─────────────────────────────────┘ │
└──────────┴──────────────────────────────────────────┘
```

### 4. データセット詳細＋プロファイル画面

#### URL

```
/datasets/{dataset_id}
```

#### 画面要素

- **ページタイトル**: データセット名
- **タブ切り替え**
  - 「プロファイル」タブ（デフォルト）
  - 「前処理プラン」タブ
- **プロファイルタブ**
  - データセット基本情報
    - 行数、列数、作成日時
  - 列プロファイルテーブル
    - カラム:
      - 列名
      - データ型
      - 欠損値数
      - 欠損率
      - ユニーク数
      - 基本統計量（数値列の場合）
      - 頻度分布（カテゴリ列の場合）
- **前処理プランタブ**
  - 「プラン作成」ボタン
  - 既存プラン一覧（関連するプランがあれば表示）

#### レイアウト

```
┌─────────────────────────────────────────────────────┐
│ CleanFlow Agent    [user@example.com]               │
├──────────┬──────────────────────────────────────────┤
│ データセット │  my_dataset                          │
│ 前処理プラン │  [プロファイル] [前処理プラン]       │
│ ログアウト  │                                       │
│            │  ┌─────────────────────────────────┐ │
│            │  │ 列名 │ 型 │ 欠損 │ 欠損率 │ ... │ │
│            │  ├─────────────────────────────────┤ │
│            │  │ age  │ int│  5   │ 0.5%   │ ... │ │
│            │  │ cat  │ obj│  0   │ 0.0%   │ ... │ │
│            │  └─────────────────────────────────┘ │
└──────────┴──────────────────────────────────────────┘
```

### 5. 前処理プラン作成画面

#### URL

```
/datasets/{dataset_id}/plan/new
```

#### 画面要素

- **ページタイトル**: 「前処理プラン作成」
- **データセット情報表示**
  - データセット名、行数、列数
- **タスク種別選択**
  - ラジオボタンまたはドロップダウン
  - 選択肢: 分類、回帰、クラスタリング
- **ターゲット列選択**
  - ドロップダウン（分類・回帰の場合のみ表示・必須）
  - クラスタリングの場合は非表示
- **プラン名入力欄**（オプション）
  - プレースホルダー: "プラン名（オプション）"
- **生成ボタン**
  - プライマリカラー
  - クリック時にローディング表示（「生成中...」）
- **生成結果表示エリア**
  - 生成されたプランのステップ一覧
  - 各ステップの名前、説明、コードスニペット
  - 「実行」ボタン
  - 「保存」ボタン

#### レイアウト

```
┌─────────────────────────────────────────────────────┐
│ CleanFlow Agent    [user@example.com]               │
├──────────┬──────────────────────────────────────────┤
│ データセット │  前処理プラン作成                     │
│ 前処理プラン │                                       │
│ ログアウト  │  データセット: my_dataset              │
│            │                                       │
│            │  タスク種別: ○分類 ○回帰 ○クラスタリング│
│            │                                       │
│            │  ターゲット列: [ドロップダウン]         │
│            │                                       │
│            │  プラン名: [入力欄]                    │
│            │                                       │
│            │  [生成]                               │
│            │                                       │
│            │  ┌─────────────────────────────────┐ │
│            │  │ 生成されたプラン:                │ │
│            │  │ 1. 欠損値補完                    │ │
│            │  │ 2. カテゴリ変数エンコード        │ │
│            │  │ [実行] [保存]                    │ │
│            │  └─────────────────────────────────┘ │
└──────────┴──────────────────────────────────────────┘
```

### 6. 前処理プラン詳細＋実行ログ画面

#### URL

```
/plans/{plan_id}
```

#### 画面要素

- **ページタイトル**: プラン名
- **プラン情報**
  - プラン名、タスク種別、ターゲット列、作成日時
- **ステップ一覧**
  - 各ステップの順序、名前、説明、コードスニペット
  - コードスニペットはコードブロック形式で表示
- **実行ボタン**
  - プライマリカラー
  - クリック時に確認ダイアログ表示
- **実行履歴セクション**
  - 過去の実行結果一覧
  - 各実行の日時、ステータス（成功/失敗）、実行時間
  - クリックで詳細表示
- **実行結果詳細**（実行後または履歴クリック時）
  - Before/After サマリ
    - 行数、列数、欠損値数などの比較
  - 各ステップの実行結果
    - ステップ名、ステータス、実行時間、エラーメッセージ（失敗時）

#### レイアウト

```
┌─────────────────────────────────────────────────────┐
│ CleanFlow Agent    [user@example.com]               │
├──────────┬──────────────────────────────────────────┤
│ データセット │  my_plan                             │
│ 前処理プラン │  タスク: 分類  ターゲット: target    │
│ ログアウト  │                                       │
│            │  ┌─────────────────────────────────┐ │
│            │  │ ステップ 1: 欠損値補完          │ │
│            │  │ 説明: ...                       │ │
│            │  │ コード: ...                    │ │
│            │  └─────────────────────────────────┘ │
│            │                                       │
│            │  [実行]                              │
│            │                                       │
│            │  実行履歴:                           │
│            │  - 2024-01-01 10:00:00 [成功]      │
│            │  - 2024-01-01 09:00:00 [成功]      │
└──────────┴──────────────────────────────────────────┘
```

## UI コンポーネント

### 共通コンポーネント

#### ボタン

- **プライマリボタン**: 主要なアクション用（青系）
- **セカンダリボタン**: 補助的なアクション用（グレー系）
- **危険ボタン**: 削除などの危険なアクション用（赤系）

#### 入力欄

- テキスト入力、パスワード入力、ドロップダウン、ファイル選択

#### テーブル

- ソート機能、ページネーション（将来拡張）

#### モーダル/ダイアログ

- 確認ダイアログ（削除確認など）
- ファイル選択ダイアログ

#### ローディング表示

- スピナーまたはプログレスバー

#### エラーメッセージ

- 赤色で表示、アイコン付き

#### 成功メッセージ

- 緑色で表示、アイコン付き

## 画面遷移フロー

```
ログイン画面
  ↓ (新規登録リンク)
ユーザー登録画面
  ↓ (登録成功)
データセット一覧画面
  ↓ (CSVアップロード)
データセット詳細画面
  ↓ (プラン作成)
前処理プラン作成画面
  ↓ (生成成功)
前処理プラン詳細画面
  ↓ (実行)
実行結果表示
```

## レスポンシブデザイン（将来拡張）

- モバイル: サイドバーをハンバーガーメニューに変更
- タブレット: サイドバーを折りたたみ可能に
